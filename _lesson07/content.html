
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deprecated Lesson 07: CNNs &#8212; deeplearning in 540 minutes  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deprecated Lesson 08: Capstone" href="../_lesson08/content.html" />
    <link rel="prev" title="Deprecated Lesson 06: How did we train" href="../_lesson06/content.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="deprecated-lesson-07-cnns">
<h1>Deprecated Lesson 07: CNNs<a class="headerlink" href="#deprecated-lesson-07-cnns" title="Permalink to this headline">¶</a></h1>
<div class="section" id="learning-objectives">
<h2>Learning Objectives<a class="headerlink" href="#learning-objectives" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>list/repeat the three ingredients to a feed forward network: input, hidden layers, output</p></li>
<li><p>classify/categorize parts of a feed forward network when presented a network architecture (as from <cite>keras.model.summary()</cite>)</p></li>
<li><p>describe a convolutional layer</p></li>
<li><p>describe a max pooling layer</p></li>
<li><p>calculate the output data shape of an image when transformed by a fixed convolutional layer</p></li>
<li><p>interpret errors with convolutional layers</p></li>
<li><p>execute a 3 layer network on the MNIST data (or similar)</p></li>
<li><p>differentiate a dense layer and a convolutional layer</p></li>
<li><p>experiment with values of dense layer and a convolutional layer</p></li>
<li><p>select a layer type depending on the input data</p></li>
<li><p>develop a 5 layer network that comprises both layer types</p></li>
</ul>
</div>
<div class="section" id="content">
<h2>Content<a class="headerlink" href="#content" title="Permalink to this headline">¶</a></h2>
<p>This lesson will be shared as a video.</p>
<ul class="simple">
<li><p>for learners: a stub notebook to get you started can be obtained from <a class="reference external" href="https://github.com/deeplearning540/lesson07/blob/main/lesson07.ipynb">the lesson03 repo</a>.</p></li>
<li><p>for instructors: the video script is available <a class="reference external" href="https://github.com/deeplearning540/deeplearning540.github.io/blob/main/source/lesson07/script.ipynb">here</a>.</p></li>
</ul>
<p>This lesson is based on the wonderful keras introduction by Walter de Back
- <a class="reference external" href="https://gitlab.com/wdeback/dl-keras-tutorial/-/blob/master/notebooks/2-convolution.ipynb">https://gitlab.com/wdeback/dl-keras-tutorial/-/blob/master/notebooks/2-convolution.ipynb</a>
- <a class="reference external" href="https://gitlab.com/wdeback/dl-keras-tutorial/-/blob/master/notebooks/3-cnn-mnist.ipynb">https://gitlab.com/wdeback/dl-keras-tutorial/-/blob/master/notebooks/3-cnn-mnist.ipynb</a></p>
</div>
<div class="section" id="check-your-learning">
<h2>Check your Learning<a class="headerlink" href="#check-your-learning" title="Permalink to this headline">¶</a></h2>
<div class="admonition-exercise-1 admonition">
<p class="admonition-title">Exercise 1</p>
<p>Fill in the blanks to produce a CNN for classification!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from tensorflow import keras
from keras.layers import Input, Dense, Dropout, Flatten, ____2D, _________2D</p>
<p>#load the data</p>
<p>#define the network
conv1 = Conv2D(16, kernel_size=(3,3), activation=’______’, input_shape=X_train.shape[1:])
conv2 = ______(32, kernel_size=(3,3), activation=’relu’)
mpool = _________(pool_size=(2,2))</p>
<p>## MLP layers
flat = Flatten()
dense1 = Dense(128, _____________)
dense2 = Dense(num_classes, __________)</p>
<p>#compile and train</p>
<p>x_inputs = Input(shape=X_train.shape[1:])</p>
<p>x = conv1(_______)
x = ______(x)
x = ______(x)</p>
<p>x = flat(x)
x = dense1(x)
output_yhat = dense2(x)</p>
<p>model = keras.Model(inputs = _______, outputs = _______, name=”hello-world-cnn”)</p>
</div>
<div class="admonition-exercise-2 admonition">
<p class="admonition-title">Exercise 2</p>
<p>The <cite>Flatten</cite> operation rearranges an input image (or feature map) into a sequence of numbers. How does it perform this?</p>
<ol class="arabic simple">
<li><p>the pixel intensities are averaged per row and concatenated</p></li>
<li><p>all rows of the input are added and provided as a result</p></li>
<li><p>all columns of the input are concatenated (from top to bottom)</p></li>
<li><p>all rows of the input are concatenated (from top to bottom)</p></li>
</ol>
</div>
<div class="admonition-exercise-3 admonition">
<p class="admonition-title">Exercise 3</p>
<p>For an input image shape of <cite>28x28</cite> what is the shape of the feature map after running the image through a single <cite>5x5</cite> convolutional filter?</p>
<ol class="arabic simple">
<li><p><cite>24x28</cite></p></li>
<li><p><cite>20x28</cite></p></li>
<li><p><cite>26x26</cite></p></li>
<li><p><cite>24x24</cite></p></li>
</ol>
</div>
<div class="admonition-exercise-4 admonition">
<p class="admonition-title">Exercise 4</p>
<p>For an MNIST input image, how many parameters does a <cite>Conv2D</cite> layer require when being defined to produce <cite>16</cite> feature maps as output and a <cite>3x3</cite> neighborhood. How many parameters does a <cite>Dense</cite> layer with <cite>16</cite> outputs have? Compute the two parameter counts!</p>
</div>
</div>
<div class="section" id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p>run the lesson notebook using the <cite>fashionMNIST</cite> dataset. Use the code below to load it. Try to reach a similar accuracy as you saw with the orginal MNIST. Does the same architecture work exactly the same with <cite>fashionMNIST</cite>?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from keras.datasets import fashion_mnist</p>
<p>(x_train, y_train), (x_test, y_test) = fashion_mnist.load_data()</p>
</li>
<li><p>using the <cite>MNIST</cite> dataset, we saw that overfitting can be problematic. When reducing the size of the network in terms of number of parameters, the downside of this is that our network looses capacity to learn features. Cut the dense layer from <cite>128</cite> neurons to <cite>64</cite> and <cite>32</cite>. What do you observe with these network sizes? Compare the accuracy of the trimmed networks with a network that uses a <a class="reference external" href="https://keras.io/api/layers/regularization_layers/dropout/">drop-out layer</a> which masks <cite>25%</cite> of the neurons.</p></li>
</ul>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">deeplearning in 540 minutes</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Lesson Modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../lesson_01/content.html">Lesson 01: Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson_01/foo.html">this is foo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson02/content.html">Lesson 02: Enter Clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson03/content.html">Lesson 03: From Clustering To Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson04/content.html">Lesson 04: Classification Performance ROCs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson05/content.html">Lesson 05: Introduction Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson06/content.html">Lesson 06: Classification by a Neural Network using Keras</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson07/content.html">Lesson 07: Monitor the training process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lesson08/content.html">Lesson 08: Networks are like onions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../lessonb01/content.html">Bonus Lesson: How did we train</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extras/design.html">Lesson Design</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Deprecated Material (will be removed in the next release)</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../_lesson01/content.html">Deprecated Lesson 01: Diving into Regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lesson05/content.html">Deprecated Lesson 05: Neural Networks as Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lesson06/content.html">Deprecated Lesson 06: How did we train</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Deprecated Lesson 07: CNNs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lesson08/content.html">Deprecated Lesson 08: Capstone</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
      <li>Previous: <a href="../_lesson06/content.html" title="previous chapter">Deprecated Lesson 06: How did we train</a></li>
      <li>Next: <a href="../_lesson08/content.html" title="next chapter">Deprecated Lesson 08: Capstone</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, Peter Steinbach.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.2.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/_lesson07/content.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>